C51 COMPILER V9.57.0.0   MAIN                                                              11/21/2019 22:00:08 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\MDK\install\Core\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <reg52.h>
   2          #include <intrins.h>
   3          #define uchar unsigned char
   4          #define uint unsigned int
   5          #define Hex2Char(x) ((x/10)*10+(x%10)-48)
   6          sbit DAT=P3^0;                  // 74HC164 Êý¾ÝÊäÈë
   7          sbit CLK=P3^1;                  // 74HC164 Ê±ÖÓÊäÈë
   8          uint show_data;                         // ½ÓÊÕÊý¾Ý
   9          uchar code tab[]={0x81,0xD7,0xC8,0xC2,0x96,0xA2,0xA0,0xC7,0x80,0x82,0xff};              // ÊýÂë¹Ü¶ÎÑ¡Êý×é       Êý×Ö0~9ºÍÈ«Ã
             -ð
  10          
  11          /**********************************************************
  12          *  º¯ÊýÃû³Æ£ºµÍ¾«¶ÈÑÓÊ±º¯Êý
  13          *  ÈÕÆÚ£º2019-9-7
  14          *  ÐÕÃû£ºZhangHJ
  15          *  ËµÃ÷£ºÇ¶Ì×Ñ­»·ÑÓÊ±
  16          ***********************************************************/
  17          void delay_ms(unsigned int mstime)
  18          {
  19   1              int i,j;
  20   1              for(i=mstime; i>=0; i--)
  21   1                      for(j=112; j>=0; j--);
  22   1      }
  23          
  24          
  25          
  26          /**********************************************************
  27          *  º¯ÊýÃû³Æ£º74HC164·¢ËÍByteº¯Êý
  28          *  ÈÕÆÚ£º2019-9-29
  29          *  ÐÕÃû£ºZhangHJ
  30          *  ËµÃ÷£º74HC164ÒÆÎ»¼Ä´æÆ÷ÊäÈëÒ»×Ö½ÚÊý¾Ý·¢¸ø¼Ä´æÆ÷
  31          ***********************************************************/
  32          void SendByte_74HC164(uchar byte)
  33          {
  34   1              uchar num,c;
  35   1              num=tab[byte];
  36   1              for(c=0; c<8; c++)
  37   1              {
  38   2                      DAT=num&0x01;           // P3^0 --> 0000 000x
  39   2                      CLK=0;                          // ÖÆÔìÒ»¸öÉÏÉýÑØ
  40   2                      CLK=1;
  41   2                      num>>=1;                        // ½«Êý¾Ý·¢ËÍµ½¼Ä´æÆ÷
  42   2              }
  43   1      }
  44          
  45          
  46          
  47          /**********************************************************
  48          *  º¯ÊýÃû³Æ£ºÅäÖÃ´®¿Ú1
  49          *  ÈÕÆÚ£º2019-11-21
  50          *  ÐÕÃû£ºZhangHJ
  51          *  ËµÃ÷£º1. ÉèÖÃ¶¨Ê±Æ÷12·ÖÆµ
  52          *                2. ÅäÖÃ¶¨Ê±Æ÷T1·½Ê½2(8Î»×Ô¶¯ÖØ×°)
  53          *                3. ¶¨Ê±Æ÷×°³õÖµ,ÉèÖÃ²¨ÌØÂÊ
C51 COMPILER V9.57.0.0   MAIN                                                              11/21/2019 22:00:08 PAGE 2   

  54          *                4. ÉèÖÃ²¨ÌØÂÊ±¶ÔöÎ»,²¨ÌØÂÊ²»¼Ó±¶
  55          *                5. ÉèÖÃ´®ÐÐ¿Ú¿ØÖÆ¼Ä´æÆ÷,8Î»Êý¾Ý,ÔÊÐí´®ÐÐ½ÓÊÕ
  56          *                6. ¿ªÆô×ÜÖÐ¶ÏºÍ´®¿ÚÖÐ¶Ï
  57          *                7. ¶¨Ê±Æ÷T1ÔËÐÐ
  58          ***********************************************************/
  59          void UartConfig()
  60          {
  61   1              AUXR &= 0xBF;   // ¶¨Ê±Æ÷T1·ÖÆµ12T
  62   1              TMOD = 0x20;    // ¶¨Ê±Æ÷1·½Ê½2(8Î»×Ô¶¯ÖØ×°)
  63   1              TH1 = 0xFD;             // ¶¨Ê±Æ÷ÖØ×°Öµ
  64   1              TL1 = 0xFD;             // ¶¨Ê±Æ÷³õÖµ
  65   1              PCON = 0x00;    // ²¨ÌØÂÊ²»¼Ó±¶ 0x80¼Ó±¶(SMOD=1)
  66   1              SCON = 0x50;    // ²¨ÌØÂÊ¿ØÖÆ¼Ä´æÆ÷,8Î»UART,REN=1
  67   1              EA = 1;                 // ´ò¿ª×ÜÖÐ¶Ï
  68   1              ES = 1;                 // ´ò¿ª´®ÐÐ¿ÚÖÐ¶Ï
  69   1              TR1 = 1;                // ¶¨Ê±Æ÷T1ÔËÐÐ
  70   1      }
  71          
  72          
  73          
  74          /**********************************************************
  75          *  º¯ÊýÃû³Æ£º´®¿Ú1ÖÐ¶Ï·þÎñº¯Êý
  76          *  ÈÕÆÚ£º2019-11-21
  77          *  ÐÕÃû£ºZhangHJ
  78          *  ËµÃ÷£º1. ½ÓÊÕÊý¾Ý
  79          *                2. Çå³ý½ÓÊÕ±êÖ¾Î»
  80          *                3. ·¢ËÍ½ÓÊÕµ½µÄÊý¾Ý
  81          *                4. µÈ´ý·¢ËÍÍê³É
  82          *                5. Çå³ý·¢ËÍ±êÖ¾Î»
  83          ***********************************************************/
  84          void UartService() interrupt 4
  85          {
  86   1              uchar temp;
  87   1              temp = SBUF;    // ½ÓÊÕÊý¾Ý
  88   1              show_data = temp;
  89   1              RI = 0;                 // Çå³ý½ÓÊÕÖÐ¶Ï±êÖ¾Î»
  90   1              SBUF = temp;    // ²é¿´·¢ËÍ´ÎÊý,ÑéÖ¤´®ÐÐ·¢ËÍ
  91   1              while(!TI);             // µÈ´ý·¢ËÍÍê³É
  92   1              TI = 0;                 // Çå³ý·¢ËÍÖÐ¶Ï±êÖ¾Î»
  93   1      }
  94          
  95          
  96          
  97          void main()
  98          {
  99   1              UartConfig();   // ÅäÖÃ´®¿Ú
 100   1              P1 &= 0xf0;
 101   1              while(1)
 102   1              {
 103   2                      SendByte_74HC164(Hex2Char(show_data));
 104   2                      delay_ms(200);
 105   2              }
 106   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    165    ----
   CONSTANT SIZE    =     11    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.57.0.0   MAIN                                                              11/21/2019 22:00:08 PAGE 3   

   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
