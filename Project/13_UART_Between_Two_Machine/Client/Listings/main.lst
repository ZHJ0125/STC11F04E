C51 COMPILER V9.57.0.0   MAIN                                                              11/22/2019 08:14:09 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: E:\MDK\install\Core\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\List
                    -ings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <reg52.h>
   2          #include <intrins.h>
   3          #define uchar unsigned char
   4          #define Hex2Char(x) ((x/10)*10+(x%10)-48)
   5          sbit DAT=P3^0;                  // 74HC164 Êý¾ÝÊäÈë
   6          sbit CLK=P3^1;                  // 74HC164 Ê±ÖÓÊäÈë
   7          uchar show_data;                        // ½ÓÊÕÊý¾Ý
   8          uchar code tab[]={0x81,0xD7,0xC8,0xC2,0x96,0xA2,0xA0,0xC7,0x80,0x82,0xff};              // ÊýÂë¹Ü¶ÎÑ¡Êý×é       Êý×Ö0~9ºÍÈ«Ã
             -ð
   9          
  10          /**********************************************************
  11          *  º¯ÊýÃû³Æ£ºµÍ¾«¶ÈÑÓÊ±º¯Êý
  12          *  ÈÕÆÚ£º2019-9-7
  13          *  ÐÕÃû£ºZhangHJ
  14          *  ËµÃ÷£ºÇ¶Ì×Ñ­»·ÑÓÊ±
  15          ***********************************************************/
  16          void delay_ms(unsigned int mstime)
  17          {
  18   1              int i,j;
  19   1              for(i=mstime; i>=0; i--)
  20   1                      for(j=112; j>=0; j--);
  21   1      }
  22          
  23          
  24          
  25          /**********************************************************
  26          *  º¯ÊýÃû³Æ£º74HC164·¢ËÍByteº¯Êý
  27          *  ÈÕÆÚ£º2019-9-29
  28          *  ÐÕÃû£ºZhangHJ
  29          *  ËµÃ÷£º74HC164ÒÆÎ»¼Ä´æÆ÷ÊäÈëÒ»×Ö½ÚÊý¾Ý·¢¸ø¼Ä´æÆ÷
  30          ***********************************************************/
  31          void SendByte_74HC164(uchar byte)
  32          {
  33   1              uchar num,c;
  34   1              num=tab[byte];
  35   1              for(c=0; c<8; c++)
  36   1              {
  37   2                      DAT=num&0x01;           // P3^0 --> 0000 000x
  38   2                      CLK=0;                          // ÖÆÔìÒ»¸öÉÏÉýÑØ
  39   2                      CLK=1;
  40   2                      num>>=1;                        // ½«Êý¾Ý·¢ËÍµ½¼Ä´æÆ÷
  41   2              }
  42   1      }
  43          
  44          
  45          
  46          /**********************************************************
  47          *  º¯ÊýÃû³Æ£ºÅäÖÃ´®¿Ú1
  48          *  ÈÕÆÚ£º2019-11-21
  49          *  ÐÕÃû£ºZhangHJ
  50          *  ËµÃ÷£º1. ÉèÖÃ¶¨Ê±Æ÷12·ÖÆµ
  51          *                2. ÅäÖÃ¶¨Ê±Æ÷T1·½Ê½2(8Î»×Ô¶¯ÖØ×°)
  52          *                3. ¶¨Ê±Æ÷×°³õÖµ,ÉèÖÃ²¨ÌØÂÊ
  53          *                4. ÉèÖÃ²¨ÌØÂÊ±¶ÔöÎ»,²¨ÌØÂÊ²»¼Ó±¶
C51 COMPILER V9.57.0.0   MAIN                                                              11/22/2019 08:14:09 PAGE 2   

  54          *                5. ÉèÖÃ´®ÐÐ¿Ú¿ØÖÆ¼Ä´æÆ÷,8Î»Êý¾Ý,ÔÊÐí´®ÐÐ½ÓÊÕ
  55          *                6. ¿ªÆô×ÜÖÐ¶ÏºÍ´®¿ÚÖÐ¶Ï
  56          *                7. ¶¨Ê±Æ÷T1ÔËÐÐ
  57          ***********************************************************/
  58          void UartConfig()
  59          {
  60   1              AUXR &= 0xBF;   // ¶¨Ê±Æ÷T1·ÖÆµ12T
  61   1              TMOD = 0x20;    // ¶¨Ê±Æ÷1·½Ê½2(8Î»×Ô¶¯ÖØ×°)
  62   1              TH1 = 0xFD;             // ¶¨Ê±Æ÷ÖØ×°Öµ
  63   1              TL1 = 0xFD;             // ¶¨Ê±Æ÷³õÖµ
  64   1              PCON = 0x00;    // ²¨ÌØÂÊ²»¼Ó±¶ 0x80¼Ó±¶(SMOD=1)
  65   1              SCON = 0x50;    // ²¨ÌØÂÊ¿ØÖÆ¼Ä´æÆ÷,8Î»UART,REN=1
  66   1              EA = 1;                 // ´ò¿ª×ÜÖÐ¶Ï
  67   1              ES = 1;                 // ´ò¿ª´®ÐÐ¿ÚÖÐ¶Ï
  68   1              TR1 = 1;                // ¶¨Ê±Æ÷T1ÔËÐÐ
  69   1      }
  70          
  71          
  72          
  73          /**********************************************************
  74          *  º¯ÊýÃû³Æ£º´®¿Ú1ÖÐ¶Ï·þÎñº¯Êý
  75          *  ÈÕÆÚ£º2019-11-21
  76          *  ÐÕÃû£ºZhangHJ
  77          *  ËµÃ÷£º1. ½ÓÊÕÊý¾Ý
  78          *                2. Çå³ý½ÓÊÕ±êÖ¾Î»
  79          *                3. ·¢ËÍ½ÓÊÕµ½µÄÊý¾Ý
  80          *                4. µÈ´ý·¢ËÍÍê³É
  81          *                5. Çå³ý·¢ËÍ±êÖ¾Î»
  82          ***********************************************************/
  83          void UartService() interrupt 4
  84          {
  85   1              uchar temp;
  86   1              temp = SBUF;    // ½ÓÊÕÊý¾Ý
  87   1              RI = 0;                 // Çå³ý½ÓÊÕÖÐ¶Ï±êÖ¾Î»
  88   1              show_data = temp;
  89   1      //      SBUF = show_data;
  90   1      //      while(!TI);             // µÈ´ý·¢ËÍÍê³É
  91   1      //      TI = 0;                 // Çå³ý·¢ËÍÖÐ¶Ï±êÖ¾Î»
  92   1      }
  93          
  94          
  95          // ÕâÊÇ´Ó»úµÄ¹¦ÄÜº¯Êý£¬¾§Õñ11.0592MHz
  96          // Ö÷º¯Êý¹¦ÄÜ£º½ÓÊÕÓÉÖ÷»ú·¢À´µÄÊý¾Ý£¬²¢½«ÆäÏÔÊ¾ÔÚÊýÂë¹ÜÉÏ
  97          // ×¢Òâ£ºSTC-ISPÈí¼þÉÕÂ¼Ê±ÐèÒªÑ¡ÔñÊ¹ÓÃÍâ²¿¾§Õñ
  98          void main()
  99          {
 100   1              UartConfig();   // ÅäÖÃ´®¿Ú
 101   1              P1 &= 0xf0;
 102   1              while(1)
 103   1              {
 104   2                      SendByte_74HC164(Hex2Char(show_data));
 105   2                      delay_ms(20);
 106   2              }
 107   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    140    ----
   CONSTANT SIZE    =     11    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1    ----
C51 COMPILER V9.57.0.0   MAIN                                                              11/22/2019 08:14:09 PAGE 3   

   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
